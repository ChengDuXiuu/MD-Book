## 查询顺序

```bash
from--where--group by--having--select--order by
```

## 登陆

```mysql
mysql -h localhost -P 3306 -u root -proot
```



## 常见命令

*   查看当前所有的数据库

    ```mysql
    show databases;
    ```

*   查询当前使用的数据库

    ```mysql
    select  database();
    ```

*   打开指定的库

    ```mysql
    use 库名
    ```

*   导入数据

    ```mysql
    source  D:\ bjpowernode.sql
    ```

*   查看当前库的所有表

    ```mysql
    show tables;
    ```

*   查看其它库的所有表

    ```mysql
    show tables from 库名;
    ```

*   查看表结构

    ```mysql
    desc 表名;
    ```

*   查看建表语句

    ```mysql
    show create table <table name>;
    ```

*   查看服务器的版本

    *   登录到mysql服务端

        ```mysql
        select version();
        ```

    *   方式二：没有登录到mysql服务端

        ```mysql
        mysql --version
        或
        mysql --V
        ```

        

## DQL（Data Query Language）语言

>   主要负责 数据 select 

**如果使用中碰到包含空格的字符串，可以使用单引号和双引号阔起来，类似于Linux中echo的用法**

### 1、基础查询

`语法：`

```mysql
 select 查询列表 from 表名;
```

`用法`

*   查询表中的单个字段

    ```mysql
    SELECT last_name FROM employees;
    ```

*   查询表中的多个字段

    ```mysql
    SELECT last_name,salary,email FROM employees;
    ```

*   查询表中的所有字段

    ```mysql
    SELECT 
        `employee_id`,
        `first_name`,
        `last_name`,
        `phone_number`,
        `last_name`,
        `job_id`,
        `phone_number`,
        `job_id`,
        `salary`,
        `commission_pct`,
        `manager_id`,
        `department_id`,
        `hiredate` 
    FROM
        employees ;
        
    或者
     SELECT * FROM employees;
    ```

*   `查询函数 `

    ```mysql
    SELECT VERSION();
    ```

*   起别名

    >   如果要查询的字段有重名的情况，可以使用别名区分

    ```mysql
     #方式一：使用as
    SELECT 100%98 AS 结果;
    SELECT last_name AS 姓,first_name AS 名 FROM employees;
    
    #方式二：使用空格
    SELECT last_name 姓,first_name 名 FROM employees;
    
    #案例：查询salary，显示结果为 out put
    SELECT salary AS "out put" FROM employees;
    ```

*   `去重`

    ```mysql
    #案例：查询员工表中涉及到的所有的部门编号
    SELECT DISTINCT department_id FROM employees;
    ```

*   `+号的作用`

    >   MySQL中 + 只起运算符作用

    *   select 100+90; 两个操作数都为数值型，则做加法运算
    *   select '123'+90;只要其中一方为字符型，试图将字符型数值转换成数值型如果转换成功，则继续做加法运算
    *   select 'john'+90;	如果转换失败，则将字符型数值转换成0
    *   select null+10; 只要其中一方为null，则结果肯定为null

    ```mysql
    SELECT CONCAT('a','b','c') AS 结果;
    #案例：查询员工名和姓连接成一个字段,并且中间使用空格隔开，并显示为 姓名
    SELECT CONCAT(last_name,' ',first_name) AS 姓名 FROM employees;
    ```

    ![image-20210726114145457](第一章-基本使用.assets/image-20210726114145457.png)



### 2、条件查询

`语法`

```mysql
select 
		查询列表
	from
		表名
	where
		筛选条件;
```

`分类：`

*   按条件表达式筛选

    ```bash
    简单条件运算符：> < = != <> >= <=
    ```

*   按逻辑表达式筛选

    ```bash
    逻辑运算符：
    作用：用于连接条件表达式
    	&& || !
    	and or not
    	
    &&和and：两个条件都为true，结果为true，反之为false
    ||或or： 只要有一个条件为true，结果为true，反之为false
    !或not： 如果连接的条件本身为false，结果为true，反之为false
    ```

*   模糊查询 配合通配符使用

    ```mysql
    like     # 支持通配符
    between and    # 包含临界值	
    in     #in列表的值类型必须一致或兼容。in列表中不支持通配符
    is [not] null   #=或<>不能用于判断null值。is null或is not null 可以判断null值
    <=>   #安全等于 不仅可以用于判断普通数值也可以判断null，可读性查
    ```

    ==通配符==

    *   % 匹配任意多个字符，包括0个

    *   _ 匹配一个字符

        

`案例`

*   查询工资z在10000到20000之间的员工名、工资以及奖金

    ```mysql
    SELECT last_name, salary, commission_pct FROM employees WHERE salary>=10000 AND salary<=20000;
    ```

*   查询部门编号不是在90到110之间，或者工资高于15000的员工信息

    ```mysql
    SELECT * FROM employees WHERE NOT(department_id>=90 AND  department_id<=110) OR salary>15000;
    ```

*   查询员工编号在100到120之间的员工信息

    ```mysql
    SELECT
    	*
    FROM
    	employees
    WHERE
    	employee_id BETWEEN 120 AND 100;
    ```

### 3、排序查询

`语法`

```mysql
select 查询列表
from 表名
[where  筛选条件]
order by 排序的字段或表达式;
```

`特点`

```bash
asc代表的是升序，可以省略(ascend)desc代表的是降序(descend)
order by子句可以支持 单个字段、别名、表达式、函数、多个字段
order by子句在查询语句的最后面，除了limit子句
```

`案例`

*   查询部门编号>=90的员工信息，并按员工编号降序

    ```mysql
    #按单个字段排序 . 添加筛选条件再排序
    SELECT * FROM employees WHERE department_id>=90 ORDER BY employee_id DESC; 
    ```

*   查询员工信息，要求先按工资降序，再按employee_id升序

    ```mysql
    #按多个字段排序
    SELECT *
    FROM employees
    ORDER BY salary DESC,employee_id ASC;
    ```

*   查询员工信息 按年薪降序

    ```mysql
    #3、按表达式排序
    SELECT *,salary*12*(1+IFNULL(commission_pct,0))
    FROM employees
    ORDER BY salary*12*(1+IFNULL(commission_pct,0)) DESC;
    ```

*   查询员工名，并且按名字的长度降序

    ```mysql
    #5、按函数排序
    SELECT LENGTH(last_name),last_name 
    FROM employees
    ORDER BY LENGTH(last_name) DESC;
    ```

    

### 4、常见函数

#### 单行函数

>   传入一个值，返回一个值。例如concat、length、ifnull等



`分类`

*   字符函数

    *   length

        ```mysql
        #获取字节个数(utf-8一个汉字代表3个字节,gbk为2个字节)
        SELECT LENGTH('张三丰hahaha');
        ```

    *   concat 

        ```mysql
        #拼接字符串
        SELECT CONCAT(last_name,'_',first_name) 姓名 FROM employees;
        ```

    *   substr 

        ```mysql
        #截取从指定索引处后面所有字符
        SELECT SUBSTR('李莫愁爱上了陆展元',7)  out_put;
        
        #截取从指定索引处指定字符长度的字符
        SELECT SUBSTR('李莫愁爱上了陆展元',1,3) out_put;
        ```

    *   instr 

        ```mysql
        #返回子串第一次出现的索引，如果找不到返回0
        SELECT INSTR('杨不殷六侠悔爱上了殷六侠','殷八侠') AS out_put;
        ```

    *   trim 

        ```mysql
        #去掉空格
        SELECT LENGTH(TRIM('    张翠山    ')) AS out_put;
        ```

    *   upper 

        ```mysql
        #变大写
        #示例：将姓变大写，名变小写，然后拼接
        SELECT CONCAT(UPPER(last_name),LOWER(first_name))  姓名 FROM employees;
        ```

        

    *   lower 

        ```mysql
        #变小写
        #示例：将姓变大写，名变小写，然后拼接
        SELECT CONCAT(UPPER(last_name),LOWER(first_name))  姓名 FROM employees;
        ```

        

    *   lpad 

        ```mysql
        #用指定的字符实现左填充指定长度
        SELECT LPAD('殷素素',2,'*') AS out_put;
        ```

    *   rpad 

        ```mysql
        #用指定的字符实现右填充指定长度
        SELECT RPAD('殷素素',12,'ab') AS out_put;
        ```

        

    *   replace

        ```mysql
        #replace 替换
        SELECT REPLACE('周芷若周芷若周芷若周芷若张无忌爱上了周芷若','周芷若','赵敏') AS out_put;
        ```

        

*   数学函数

    *   round

        ```mysql
        SELECT ROUND(-1.55);
        SELECT ROUND(1.567,2); # 四舍五入并保留两位
        ```

    *   ceil

        ```mysql
        SELECT CEIL(-1.02);#向上取整
        ```

    *   floor

        ```mysql
        SELECT FLOOR(-9.99);#向下取整
        ```

    *   truncate

        ```mysql
        SELECT TRUNCATE(1.69999,1);#截断
        ```

    *   mod

        ```mysql
        /*
        mod(a,b) ：  a-a/b*b
        
        mod(-10,-3):-10- (-10)/(-3)*（-3）=-1
        */
        SELECT MOD(10,-3); #取余
        SELECT 10%3;
        ```

*   日期函数

    *   NOW

        ```mysql
        #now 返回当前系统日期+时间
        SELECT NOW();
        #可以获取指定的部分，年、月、日、小时、分钟、秒
        SELECT YEAR(NOW()) 年;
        SELECT YEAR('1998-1-1') 年;
        #从字段中获取年
        SELECT  YEAR(hiredate) 年 FROM employees;
        ```

    *   CUREATE

        ```mysql
        #curdate 返回当前系统日期，不包含时间
        ```

    *   CURTIME

        ```mysql
        #curtime 返回当前时间，不包含日期
        ```

    *   STR_TO_DATE

        ```mysql
        #str_to_date 将字符通过指定的格式转换成日期
        
        SELECT STR_TO_DATE('1998-3-2','%Y-%c-%d') AS out_put;
        
        #查询入职日期为1992--4-3的员工信息
        SELECT * FROM employees WHERE hiredate = '1992-4-3';
        
        SELECT * FROM employees WHERE hiredate = STR_TO_DATE('4-3 1992','%c-%d %Y');
        ```

    *   DATE_FORMAT

        ```mysql
        #查询有奖金的员工名和入职日期(xx月/xx日 xx年)
        SELECT last_name,DATE_FORMAT(hiredate,'%m月/%d日 %y年') 入职日期
        FROM employees
        WHERE commission_pct IS NOT NULL;
        ```

*   其他函数

    *   VERSION
    *   DATABASE
    *   USER
    *   DATEDIFF : 计算两个日职差值几天

*   流程控制函数

    *   if函数

        ```mysql
        #三目元算符效果
        SELECT IF(10<5,'大','小');
        
        SELECT last_name,commission_pct,IF(commission_pct IS NULL,'没奖金，呵呵','有奖金，嘻嘻') 备注
        FROM employees;
        ```

    *   case函数

        *   格式一

            ```bash
            #switch case 的效果
            case 要判断的字段或表达式
            when 常量1 then 要显示的值1或语句1;
            when 常量2 then 要显示的值2或语句2;
            ...
            else 要显示的值n或语句n;
            end
            ```

            ```mysql
            SELECT salary 原始工资,department_id,
            CASE department_id
            WHEN 30 THEN salary*1.1
            WHEN 40 THEN salary*1.2
            WHEN 50 THEN salary*1.3
            ELSE salary
            END AS 新工资
            FROM employees;
            ```

        *   格式二

            ```bash
            #类似于 多重if 效果
            case 
            when 条件1 then 要显示的值1或语句1
            when 条件2 then 要显示的值2或语句2
            。。。
            else 要显示的值n或语句n
            end
            ```

            ```mysql
            #案例：查询员工的工资的情况
            如果工资>20000,显示A级别
            如果工资>15000,显示B级别
            如果工资>10000，显示C级别
            否则，显示D级别
            ```

            

#### 分组函数

>   传入一组值，返回一个值。一般用于统计。又称为统计函数、聚合函数、组函数

`特点`

```bash
1、sum、avg一般用于处理数值型.max、min、count可以处理任何类型
2、以上分组函数都忽略null值
3、可以和distinct搭配实现去重的运算
4、count函数的单独介绍,一般使用count(*)用作统计行数
5、和分组函数一同查询的字段要求是group by后的字段
	比如SELECT AVG(salary),employee_id  FROM employees; 其中employee_id结果有很多行，而分组函数AVG只有一行，表结构不对。 
```



*   sum   求和
*   avg    平均值
*   max    最大值
*   min    最小值
*   count  计算个数 (如果计算某个列，当列中有一个为null则不会统计)



`案例`

```mysql
#简单的使用
SELECT SUM(salary) FROM employees;
SELECT AVG(salary) FROM employees;
SELECT MIN(salary) FROM employees;
SELECT MAX(salary) FROM employees;
SELECT COUNT(salary) FROM employees;

#和distinct搭配   ---> 去重后求和
SELECT SUM(DISTINCT salary),SUM(salary) FROM employees;
SELECT COUNT(DISTINCT salary),COUNT(salary) FROM employees;

#count
SELECT COUNT(salary) FROM employees;   #当列中有一个为null则不会统计
SELECT COUNT(*) FROM employees;   #统计表行数，用的较多
SELECT COUNT(1) FROM employees; #1 可以常量值比如说2、‘hello’等。
#效率：
MYISAM存储引擎下  ，COUNT(*)的效率高
INNODB存储引擎下，COUNT(*)和COUNT(1)的效率差不多，比COUNT(字段)要高一些
```

### 5、分组函数

>   如上

### 6、分组查询

`语法`

```mysql
select 查询列表
from 表
【where 筛选条件】
group by 分组的字段
【order by 排序的字段】;
```

`特点：`

1.  和分组函数一同查询的字段必须是group by后出现的字段
2.  分组可以按单个字段也可以按多个字段
3.  可以搭配着排序使用
    

`案例`

```mysql
#1.简单的分组

#案例1：查询每个工种的员工平均工资
SELECT AVG(salary),job_id
FROM employees
GROUP BY job_id;

#案例2：查询每个位置的部门个数
SELECT COUNT(*),location_id
FROM departments
GROUP BY location_id;
```











### 7、连接查询

















### 8、子查询































### 9、分页查询

















### 10、union联合查询





























## DML（Data Manipulate Language）语言

>   主要负责 数据 操作















## DDL（Data Definition Language）

>   主要负责库表定义操作，比如库表的crud

























## TCL（Trasaction Controller Language）语言

>   事务、视图、存储过程等相关操作