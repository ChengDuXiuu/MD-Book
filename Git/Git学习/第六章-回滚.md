## 暂存区回滚

>   从暂存区 将监管文件修改为不可监管文件

```bash
git reset xxx   #指定文件从监管状态(暂存区)恢复到未监管状态
git reset .     #将所有暂存区文件全部恢复到未监管状态
```

![image-20210712132501089](第二章-常用命令.assets/image-20210712132501089.png)





## 本地仓库回滚

1.  获取要回滚的版本号

    ```bash
    git log
    ```

    ![image-20210713150755316](第六章-回滚.assets/image-20210713150755316.png)

    >   我想要删除掉 '提交回滚测试到本地仓库' 这一块修改的代码，即回滚到上一个版本，那么拷贝上一个版本号 ，即黄色底色的字符串

2.  回滚到指定版本号

    ```bash
    git reset --hard 版本号
    ```

    ![image-20210713150953980](第六章-回滚.assets/image-20210713150953980.png)



## 本地仓库回滚后再回滚回去

>   如上，我们往前回滚了一个版本，但是发现往前回滚不对，需要复位即往后回滚，怎么办？

1.  获取版本号

    >   不能再使用git log查看版本号了，因为随着回滚版本号已不存在。使用git reflog

    ![image-20210713151624380](第六章-回滚.assets/image-20210713151624380.png)

    ![image-20210713151720025](第六章-回滚.assets/image-20210713151720025.png)

    

    

2.  版本复位

    ```bash
    git reset --hard 版本号
    ```

    ![image-20210713151849573](第六章-回滚.assets/image-20210713151849573.png)

## 远程仓库回滚

### 1、回退最后一次远程操作

**第一种方式**

1.  背景准备

    ![image-20210719100659825](第六章-回滚.assets/image-20210719100659825.png)

    ![image-20210719100852747](第六章-回滚.assets/image-20210719100852747.png)

2.  回退

    ```bash
    git revert HEAD
    git push origin master
    ```

    ![image-20210719101223412](第六章-回滚.assets/image-20210719101223412.png)

    ![image-20210719101310056](第六章-回滚.assets/image-20210719101310056.png)

    ![image-20210719101327314](第六章-回滚.assets/image-20210719101327314.png)

**第二种方式**（慎用）

>   如果本地仓库还未发生修改，可以使用，一旦本地仓库发生了修改，最好不要使用此方式

1.  背景准备

    ![image-20210719101703652](第六章-回滚.assets/image-20210719101703652.png)

2.  回退

    ```bash
    git reset --hard HEAD^
    git push origin master -f
    ```

    



### 2、回退远程仓库指定版本号

1.  环境准备

    ![image-20210719104924631](第六章-回滚.assets/image-20210719104924631.png)

2.  先回退本地分支仓库

    ```bash
    git reset --hard "commit id"    # 可以使用git reflog 获取
    ```

3.  强制推送远程

    ```bash
    git push gitee master -f
    ```

    ![image-20210719105122770](第六章-回滚.assets/image-20210719105122770.png)

    ![image-20210719105203455](第六章-回滚.assets/image-20210719105203455.png)